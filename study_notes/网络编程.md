###网络编程
---
> 17.7.7  by stan

---

####整体印象
所熟知的就是客户端与服务器的通信是使用HTTP协议的，客户端是浏览器，服务器指的是服务器软件，其实二者最重要的作用就是从http报文中解包出必要的信息，或者将要发送的信息使用http协议打包，然后发送，由于涉及到报文的解析，这个过程很是繁琐，我知道你并不想接触这样的最底层。  
那么在高级一点，已经有浏览器这个自然存在的客户端了，因而不需要为客户端而发愁，那么服务器呢？最重要的就是怎样得到一个服务器，我又该如何与服务器交互，得到浏览器请求或发送的信息呢？这里出现的就是WSGI，首先，WSGI是针对python的，其他语言也存在类似的东西，但是都不叫这个名字，WSGI全称服务器网关接口，只要得到一个支持WSGI的python服务器，然后写一个WSGI函数，WSGI就可以运行了： 
 	
	def application(environ, start_response):
    	start_response('200 OK', [('Content-Type', 'text/html')])
    	return [b'<h1>Hello, web!</h1>']

以上就是一个WSGI函数，服务器会传递给这个函数两个参数，前一个是一个字典，它包含了所有从http报文中解析出来的请求信息，后者是一个负责发送回应的函数。  
是不是很完美，正合我意？我们既不需要解析协议，又能拿到所有来自浏览器的信息，同时只需要把我们要返回的信息交给start_response就可以，完全不需要封装。  

####测试
在python里面已经自带了一个提供测试的wsgi服务器，我们只需要提供上述函数，他就可以工作了：
 
	from wsgiref.simple_server import make_server
	# 导入我们自己编写的application函数:
	from hello import application

	# 创建一个服务器，IP地址为空，端口是8000，处理函数是application:
	httpd = make_server('', 8000, application)
	print('Serving HTTP on port 8000...')
	# 开始监听HTTP请求:
	httpd.serve_forever()

是不是很完美？


####网络框架
那么网络框架的存在又有什么意义呢？  
使用wsgi存在最大的两个问题，第一我们需要写很多很多的代码区分识别浏览器请求不同页面时的处理函数，很繁琐，虽然很容易做到，第二我们要以字符串的形式提供巨大的html页面，甚至是css，javascript。  
这便是网络框架存在的意义了，它可以以一种很简洁的方式让我们设置如何应对不同的页面请求，同时它们也往往会融合一些模板系统，让我们来以更方便的形式返回html页面，那么，什么又是模板系统呢？

####模板
对于一个纯粹的html页面，明显他几乎是不可更改的，那么它产生的页面就是一个静态网页，换句话说里面的内容不能灵活的更新，要想更新几乎必须要重写一个新的页面，这很不合理。  
于是便有了模板，我们只需要根据模板系统的语法，在特定的位置用变量去替代固定的字段，然后使用模板提供的函数我们就可以灵活的，动态的更新这些字段的值。  



当然以上所述只是这几个东西的核心功能，事实上一个真实的会比这个要复杂，提供更多的功能。


####自己动手
从上面所说的可以看出，最关键的几个大块就是：  
浏览器  
服务器  
WSGI  
网络框架  

这些东西我们是不是都可以手工完成一个呢？毫无疑问，我们有socket这样负责接发信息的最底层模块，那么理论上我们就可以使用它完成一个浏览器，服务器。  
但是呢，明显，浏览器这个东西没啥必要去手动做，到处可得。  
那么服务器呢？是的，我的确可以手动完成一个服务器，详情见教程[https://my.oschina.net/leejun2005/blog/486771](https://my.oschina.net/leejun2005/blog/486771 "自己动手搭建服务器")

WSGI自然就包含在服务器之中了  
网络框架呢？
