## C语言笔记

我决定认真一点学学C语言，也许可以坚持下去，希望如此吧。



### main函数的问题

如果有点基础，就知道main函数应该有返回值`int`，正常退出应该返回`-1`

另外一个重要的问题是main函数是否需要有参数呢？

常见的形式大概如下：

~~~c
int main()
{
    return 0;
}
~~~

~~~c
int main(int argc, char *args[])
{
    return 0;
}
~~~

也许在某些场合下你也会发现这种形式：

~~~c
int main(int argc,char *argv[],char *envp[])
{
    return 0;
}
~~~

以及这种形式：

~~~c
int main(void)
{
    return 0;
}
~~~

按照我查阅的[资料](https://www.cnblogs.com/bianchengzhuji/p/9783772.html), 其实C标准里只给了前面的两种形式，即带参的和不带参的。第三种形式多出来的那个参数一般是编译器给的，是环境变量，而最后一种形式才是标准中给出的无参数`main`函数的标准形式

Ps. 以上所有都是几乎直接摘抄自上述资料的，当然有些细节我就省略掉了。



总而言之，我们应该使用上述两种形式中的一种，如果需要参数请选择第二种，不需要请选择第四种。所以，是否有某些情况下不得不选择第二种呢？

我还真碰到了。

在SDL中，如果代码里面的main函数写成第一种形式，编译会失败，即必须写成第二种形式。这种情况是如何发生的，如果小心检查一下，就可以发现原来在某个SDL头文件中，通过宏定义把`main`定义为了`SDL_main`，而`SDL_main`的声明被声明成了带参形式。



### 格式化输出

printf用于格式化输出，常用的类型是：

~~~c
d  //十进制整数
u  //十进制无符号整数
f  //小数，单双精度
s  //字符串
lu //32bit无符号整数
llu  //64bit无符号整数
~~~

printf的格式化的完整形式为：

~~~
%[flags][width][.precision][length]specifier
~~~

我觉得对于我来说，最常用的也就是指定一下输出的宽度，对齐，填充。

width是整体的宽度，如果是小数的话，就是整数部分加上小数点加上小数的位数，所以必须要保证够用，否则就会出问题。

flags默认是没有，此时是右对齐，前面填充空格。设置为`-`,就是左对齐，后面填充空格，如果设置为`0`， 那么意味着我们想要填充0，此时是右对齐，明显，没人会想在左对齐的情况下，在右边填充0

至于其中的length字段是`h, l, L`，一共三种选择，分别适用于短整型，长整型，长浮点数。



### 文件读写

文件读写只需要标准输入输出头文件即可。

类似与python，需要有一个文件描述符，然后在这个文件描述符上执行读写操作即可。

`c` 中，文件描述符是一个`FILE`类型的指针，打开文件使用`FILE *fopen(char *filename, char *mode)`函数，如下：

~~~
FILE *fi = fopen("test.o", "rb");
~~~

模式和python是一样的。

~~~c
int fclose(FILE *fp);
~~~

读写最简单的函数是单个字符的读写，使用:

~~~c
int getc(FILE *fp);
int putc(int c, FILE *fp);
~~~

另外还提供行级别的输入输出:

~~~c
char *fgets(char *lines, int maxline, FILE *fp);
int fputs(char *line, FILE *fp);
~~~

